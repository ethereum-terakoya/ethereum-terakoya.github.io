---
title: 第2回「ブロックチェーンの研究課題から見える可能性」
date: 2021-06-10
slug: students2
group: students22222
---

## 目次

- 1.Introduction
- 2.Details
  - 2.1 プライバシーを考慮したブロックチェーン連携による取引記録証明技術の提案
  - 2.2 ブロックチェーン向けゼロ知識証明の研究
  - 2.3 ディスカッション
  - 2.4 まとめ

## 参加者一覧

- 富士通株式会社 データ&セキュリティ研究所 ブロックチェーンエコノミー PJ シニアリサーチャー

  - 坂本拓也

- 日立製作所 研究開発グループ セキュリティ研究部所属

  - 長沼　健

* 博報堂ブロックチェーン・イニシアティブ

  - 伊藤 佑介

- クーガー株式会社（主催）

  - 石井 敦

## 1. Introduction

ブロックチェーンの研究開発は様々な企業により行われているが、その中でも現在進行形で研究されている２企業から最新の研究課題を発表頂き、今後のブロックチェーンの可能性を議論していく。

## 2. Details

### 2.1 プライバシーを考慮したブロックチェーン連携による取引記録証明技術の提案

<p style="margin-top: -1em;font-weight: bold;font-size: 1.2em;margin-left: 1em;">
  坂本拓也 | 富士通株式会社研究本部データ＆セキュリティ研究所シニアリサーチャー
</p>

#### 富士通ブロックチェーンの取り組み

富士通では分散台帳の機能にフォーカスしブロックチェーンを使った独自技術の研究開発を進めブロックチェーンのセキュリティー強化など機能拡張、そして様々な事業者と連携をして情報や価値を改ざんなくつなげる基盤としてエコシステム化の連携、データ利活用などの拡大に取り組んでいる。

#### 富士通のアクティビティについて

基盤技術をして様々なブロックチェーンを連携した取引を可能とするブロックチェーン連携技術（コネクションチェーン）の一部をさらに標準化、ブロックチェーンの OSS の大手である Hyperledger で Cactus として標準化を進め、さらに応用としてユーザーの独性などのアイデンティティーデータを自身で活用することを可能にする分散型アイデンティティーであったり電力の需要間での取引を可能にするサプライチェーン/トークンエコノミーなども進めている。これまでの活動としてブロックチェーン連携が２０１７年、分散型アイデンティティーが２０１９年、今現在も研究を進めている。基盤技術とその標準化から応用まで広く取り組んでいるということが富士通での活動である。

#### プライバシー強化技術、特にゼロ知識証明

プライバシーは法的側面化の強化もあり、ユーザーにまつわる様々データ利活用にはプライバシー強化は重要な課題である。また、様々なプライバシー強化技術の研究が進められている。

世界経済フォーラム２０１９で紹介された最も注目されているの５つの技術
・差分プライバシー…特定の個人がデータに含まれているかわからない指標を使ってデータにノイズをかけて匿名する技術
・統合分析…データを集積せずに色々なところにバラバラであるままで計算をしデータ解析をするような技術、AI と連携し使われる技術
・準同型暗号…暗号化したまま計算可能な技術
・秘密分散＋ MPC…秘密分散データを元データが分からないように分割し個々のデータを元に計算して集約して結果を得るという技術
・ゼロ知識証明…証明したい情報を明かすことなくその情報に関することを証明する手法で分析などに関係なく個々のデータに着目してプライバシーを保護をすることに使える技術
証明したい情報を明かすことなく、その情報に関することを証明する手法とは、その情報を知らないとできない計算をすることで証明することである。例えばある公開鍵に対応する秘密鍵を知っていることを秘密鍵に明かさずに証明するという場合を考えてみると証明者が秘密鍵を知っている証明者、検証者は秘密鍵を知らない。証明者が検証者に秘密鍵を知っていることを伝えようとする。まず検証者が乱数値を生成して証明者に渡す。証明者が乱数値で秘密鍵に署名する。そして検証者がその署名を公開鍵で使って検証すると秘密鍵を知っているということがわかるということなる。この時、証明者は検証者に秘密鍵の中身は明かしてないが知っているということが伝わっているということで知識を与えずに証明しているということが言える。証明者は秘密鍵自体を検証者に伝えてないが秘密鍵を持ってないと正しい署名を作ることができないので持っていることを伝えることができるということである。何を証明したいかを考えてそれに合うプロトコルを作れば様々なことを証明が可能である。様々な証明を可能とするゼロ知識証明のプロトコルが考えてられており、それを実証したライブラリーも公開されている。idemix, zkSNARKs, Bulletproof など色々なプロトコルが存在している。

#### 分散型アイデンティティーとプライバシー強化技術

分散型アイデンティティーとは

インターネットでアイデンティティー情報を自分で制御する要求というのが高まっている。分散型アイデンティティーは自分が制御することにフォーカスしており主権型アイデンティティーとも言われている。リアルな世界だと警察署から運転免許証を受け取る。そうすると警察に断りを受けることもなく例えば銀行だと運転免許証を使い銀行口座を開設する時の身分証として使うことができる。一方サイバーの世界だと自身のアイデンティティー情報は色んなところにあるはずだが自由に使うことができないという状況にある。そこで第三者に確認されたアイデンティティー情報をデジタル化し第三者に左右されずに使えるようにするためのしくみの実現が進められている。これにより自身で所有するさまざまなアイデンティティー情報を組み合わせ口座開設や就職活動、アパートの賃貸契約するなどの紙の証明を集めることなくサイバー上で行うことができる。分散型アイデンティティーは分散型 PKI という呼ばれ方もする。最近では首相関係による Trusted Web 推進協議会でのホワイトペーパーでも Trust 実現を使う技術として位置付けされていたり、欧州ではコロナのワクチンを打った証明のために使うということも考えられており分散型アイデンティティーは社会の基盤なり Trust を実現できる技術である。

課題：アイデンティティー開示証明時のプライバシー

第三者に確認されたアイデンティティー情報を利用できるようにするにはどうすればいいか単純に考えるとアイデンティティー情報が書かれたファイルに第三者にデジタル証明をしてもらう、証明者はデジタル証明付きのファイルを検証者に送信し、検証者は発行者先の公開先で検証する。必要な情報のみを開示することが望ましいが普通の証明だと全項目を開示しないと検証できないので必要な情報に限定することができないということである。

解決技術：ゼロ知識証明による秘匿開示証明技術

富士通ではゼロ知識証明を使い情報を隠して情報を伝えるプロトコルを開発。自身の正確な属性を伝えることなしに情報の一部を使い正当性を証明することが可能である。従来、発行者がアイデンティティー情報の範囲を決める必要があったが証明者と検証者側で秘匿開示を柔軟に対応することができる。またアイデンティティー流通技術 IDYX を開発しており実証実験などで使用。取引関係を元に発行者の信用度を算出するしくみなどアイデンティティー流通に必要となる機能を提供する基盤である。この技術のサービス利用者が自身の属性を開示することで本技術を適用できるようにしている。これによりプライバシーを考慮したアイデンティティー情報の開示が可能である。

#### ブロックチェーン連携とプライバシー強化技術

デジタルトラストとブロックチェーン連携

ビットコイン、アルトコインなどの仮想通貨を交換する取引所のサービスやアプリケーションは通常透明性がない。つまり実際には何が起こっているか分からず不正が起こっている可能性がある。またブロックチェーンをまたがる取引を実現させるために複数のブロックチェーンを連動させてお金を移動し交換させようとするとその間で失敗する可能性もありえる。

富士通はコネクションチェーンというものを開発しており異なるブロックチェーン間での価値の交換、スマートコントラクトを拡張し取引の透明性を確保する。このしくみにより人手の処理をブロックチェーンで置換し、システム全体での透明性確保が可能である。

トークンエコノミーへの展開

地域通貨を使いテレワーク用などのスペースの一時利用権を購入したり、ポイントを使い一時的に自転車を借りる権利を購入することが出来るなど権利の売買が可能になるので誰が何を買ったなどを取引記録やパーソナルデータが分散台帳にはいることになる。

課題：トークンエコノミーでの登録記録活用とプライバシーの両立

大きな課題が二つ、一つ目は連携ブロックチェーンに分散されて保存されているため取引記録を開示、証明しようとした時に開示する情報をプライバシーに考慮して一つの情報のみ開示をしようとした時、連携ブロックチェーン次第になるということが考えられる。
二つ目はコンソーシアム参加企業からのアクセスを防ぐ必要である。

解決技術：秘匿開示証明技術の登録記録活用への適用

様々な取引ができるように管理者が取り込む項目を設定できるようにし、取引記録の代わりに証明用の台帳を保存し分散台帳には証明用の台帳をおくようにする。そうすることで取引記録だけを開示できるようになる。項目ごとに取得開示できるしくみをゼロ知識証明を使い構築した。

#### 質疑応答

**Q1.**W3CVC との関連は準御しているのか？

**A.**まだ合わせこめていない。このプロトコルは Hyperledger Indy の上で動くように開発されており id mx というゼロ知識証明のプロトコルがのっていて、それを拡張し文字の一部を隠す証明をのせている。Indy が W3CVC に対応するように作り替えている状態なのでいずれは対応した状態で動くようになると思いますがそれを使わせていただいてるだけの状態なので現時点では対応はしていない状況である。

**Q2.**コネクションチェーンで接続した際に個人 ID の同一性はどのように確保されているのか？

取引事業者の ID がチェーンごとに E-mail と氏名などで分かれているなどの場合があると思うが。

**A.**アカウントの情報を認証用のサーバーを用意し置き換えてアクセス出来るつくりにしている。

**Q3.**コネクションチェーンのパフォーマンスがボトルネックになることになることはないのか？

**A.**コネクショクションチェーンはブロックチェーンの Hyperledger Fabric を使用している。Hyperledger Fabric のスピードに依存してしまうのでそこがネックである。

**Q4.**コネクションチェーンのインセンティブは今後どのようになっていくのか？

**A.**やり取りする時に手数料をとるのでその手数料がとれるということでビジネスになるということが考えられる。

### 2.2 ブロックチェーン向けゼロ知識証明の研究

<p style="margin-top: -1em;font-weight: bold;font-size: 1.2em;margin-left: 1em;">
  長沼　健　| 株式会社日立製作所　社会システム研究部
</p>

東大卒、日立研究開発グループ入社、東大の複雑理工学選考に戻り、大学院を卒業、その後日立に戻る。この大学院３年間の研究の一部を紹介する。

ブロックチェーンでどうやってゼロ知識証明を使うのか？

透明性とプライバシーを両立するための規律として使われている。ブロックチェーンの台帳情報はだれでも閲覧できるのでプライバシー情報が守れない。透明性 Max のプライバシー０の関係である。そこでプライバシー情報を暗号化（Hash 化）し情報を守る。暗号化したらマイナーが正当性を確認できない問題が生じる。そこで正当性を証明するゼロ知識証明を付ける。

自身の社会人博士専攻としてのテーマであるゼロ知識証明（zk-SNARK）を発展させる研究しており、いくつかの課題があり、まず量子計算計算機へ耐性を有していないこと、信頼できる第 3 者によるパラメータ生成をどう実現化するかである。

#### 応用：セキュアスマートコントラクト

具体例：セカンドプライスオークション例。通常のオークションは例えばヤフーオークション、払ってもいい最高金額をベットし、最高価格を付けた人が落札する。セカンドプライスオークションは落札者が支払う金額は 2 位の人の金額を支払う。入札者に有利なオークション形式である。分散台帳が誰でも見ることができると入札が成り立たない。公開入札、セリになってしまい、セカンドプライスオークションにならない。出品者にのみ入札状況がみられるようにした場合、出品者が一番高い入札金額に近いセカンドプライスを引数に対して SC 実行する不正が可能になる。このようにセカンドプライスオークションをブロックチェーン上で実行するのは難しい。ここにどうゼロ知識証明を利用するかというと、まずスマートコントラクトとしてブロックチェーン上にセカンドオークションのコードをデプロイする。ファーストオークションのようにならない様、そして不正が入らない様に各入札者の入札金額をハッシュ値を用いて、非公開する。そして、例えばアリスの公開鍵を使って、各入札金額と各 Hash 値を seller（このスマートコントラクトの実行者）に渡し、seller がそれを元にスマートコントラクトを実行する。そうして、winner と 2nd price の算出を行う。最後に seller は本当に正しく実行をしたかの証明をゼロ知識証明として台帳に書き込む事で、入札金額は明かせないが、正しくその金額を利用した事を証明できる。もし、その結果に不正がある場合でも、Miner がチェックをする事が出来る。暗号化されている入札金額の数値とゼロ知識証明を使って正当性の確認が出来るが、この様なところでスマートコントラクトの引数を取得したままスマートコントラクトの実行が出来る使い方ができるのが、ゼロ知識証明である。

#### 性能評価実験

評価方法は、量子計算機への耐性を考慮し、LWE 暗号方式をベースに方式設計して、zk-SNARK の標準ライブラリ libsnark の一部機能を利用し実装している。
実行結果は、ユーザー処理時間（ゼロ知識証明生成）では回路サイズに比例して処理時間が大きくなり、Hash 関数を使う評価には２１０秒、３００ GB のメモリが必要になる計算だが、実用的なユースケースとしては３００ GB は少し大き過ぎるのが課題である。
Miner 処理時間（ゼロ知識証明検証）では処理時間は常に一定で、大体１ミリ秒ぐらいで固定なので、実用的である。

#### 研究のまとめ

・量子計算機耐性を有する zk-SNARK 方式を提案、実装評価

・Trusted setup の必要ない方式も提案、実装評価

・Universal circuit にも対応

・Hyperledger Fabric 向けの実装アーキテクチャを設計

・ゼロ知識証明初心者向けに、いくつかのガジェット作成

#### 今後の課題

１、ゼロ知識証明生成の処理軽量化
量子計算機耐性を持たせると非常に処理が重たくなってしまう事があるので軽量化することが課題である。

２、初心者向け＆開発効率向上に向けたガジェットの拡充
ゼロ知識証明を扱うのは敷居が高いと思う人が多い。そういった方向けツールを作っていくことが課題である。

#### 質疑応答

**Q、**セカンドオークションの実装で、スマートコントラクトを実行する Node にはデータが漏れてしまうのではないか？

**A、**スマートコントラクトを実行する人だけには取得データを全部伝えないといけない。そこも課題の一つである。

**Q、**Miner が検証するインセンティブはあるか？

**A、**ブロックを確定することによってビットコインなどをゲットできるので、基本的には通常通りのインセンティブである。

**Q、**ゼロ知識証明のどんな汎用性があるか、典型的に何に使えそうか？

**A、**幾つかなユースケースはあり、典型的なのは送金である。例えば現在ブロックチェーンの取引は全てオープンなので誰がビットコインを売ったかなども把握出来てしまい市場に影響も出るので、ゼロ知識証明が使えれば価格安定に繋がると考えられる。
また個人情報を隠したまま署名が出来るなど。ゼロ知識証明が盛り上がっている要因としては、応用範囲が広いという事が大きい。ゼロ知識証明の重要なポイント「プライバシーを担保しながら透明性との良い按配を付けれる技術」は使い勝手が良く色々なユースケースがある。

### 2.3 ディスカッション

#### ゼロ知識証明の限界について

**坂本:**ゼロ知識証明でどう事にプロトコルを作るのか、が難しい。結局何がしたいのかの要件を定義するのが難しい。アイデンティティの面で考えるのが、どういう隠し方をしたら皆んなはプライバシー守れたと思うのか。
「現在は免許証も見せてるし、そんなに細かい事する必要があるのか？」と言う人もいるので、皆に受け入れられる要件を決めるのも難しい。

**石井:**技術的に毎回、手工を考えないといけない事もあるが、毎回データをそもそもどれくらい取得するのかが、課題としてある。という事である。

**長沼:**坂本さんがおっしゃる通りだと思う。理論的な限界というよりも、実際に使う段階での必要性。トランザクションのデータ量も増え、それに伴い金額も増える。オーバーヘッドになるので、そこまでしてプライバシーを守るのかという意見はある。

**石井:**「個人情報の非開示ではなく、企業法人情報の非開示では応用方法が広いのではないか」と質問がきている。個人の場合は自分の意思で選択が出来るかと思う。企業の場合は開示するもの、しないものがあるが、それでも要件は難しいのかもしれない。

**伊藤:**例えばコンテンツ業界の場合、IP を貸すかを判断する時に相手側の企業の取引実績などが信用に繋がり判断材料になる。過去の送金実績や守秘義務などで内容は明かせない部分にゼロ知識認証が使えそうである。

**石井:**その時には、証明されていると感じないといけない部分が難しそうだ。

#### 日立 ⇆ 富士通間での質疑応答

**長沼:**実はディセントライズ・アイデンティティが大好きで、「日立でも、しよう！」と言っているがイマイチ盛り上がっていない。一方、富士通では IDYX をされて、製品化もされている。ディセントライズじゃなく、Google ID や Facebook ID、Apple ID を使うセントライズで良いのではと思う人もいるが、言われたりするか？その場合どの様に返事するのか？

**坂本:**アイデンティティで言えば、色々な会社が入り繋がってきて、基本的なコンソーシアムで組む場合はブロックチェーンを使ってするのが良いと提案、国際化されて色んな所が使う場合は一つの ID じゃない方が良いとはなる。ただこの件はいつも苦しむ話である。富士通はプラットフォームなどの基盤技術も提供しているので、富士通がプラットフォームを提供したら良いのでは。

**長沼:**でもちゃんと製品化までいっているのが羨ましいなと思っている。

**坂本:**そこは研究所ではなく別の部署が売り込みにいき、実証実験が進んでいるからだと思う。

**石井:**ゼロ知識証明で、どうしてもオーバーヘッドの部分で演算など掛かると思うが、パフォーマンス（処理速度など）を向上する研究などは進んでいるか？

**長沼:**SNARK はネックなので、日進月歩で進んでいる所だ。

**石井:**アルゴリズムで高速化するのか？

**長沼:**色々ある。並列化したり、アルゴリズム自体も変えてしまったりなど。

**石井:**画期的に早くするというのは難しいと思うが、ゼロ知識証明を使わない処理と遜色がない位のスピードになれば汎用的になっていくと思う。

**長沼:** ゼロ知識証明の限界の一つになるが、そうはならないと言うのはあるかと。中々普通の処理にはならない。

**石井:**では、計算やマイニングなどの課題、実際にどこで動かすか、などを並行して進めている形か。

**坂本:**スケーラビリティも我々取り組んでいるが、基本的にはブロックチェーンでしてしまうと遅いから、どこまでブロックチェーンのセカンドレイヤーでするかという話はある。ゼロ知識証明は、高速なアルゴリズムを生み出すのは難しいので手はつけられていない。世の中としたら、速いプロトコルは生み出されているのでそれを使っていく。それでも結局はゼロ知識証明をしないといけないので、しない事に比べると速くはならない。ある程度オーバーヘッドは出てしまう。

#### イベント参加者からの質問

**Q、**人材業界でのブロックチェーンの応用は研究されているが、経歴自体の真偽が証明できないと中々普及は難しいと思う。ゼロ知識証明をリファレンスチェックなどに応用するアイデアはあるか？

**A、**

**長沼 : **まさに富士通の IDYX が使えるのでは。これから大学自体も無くなってしまう場合でも、卒業証書の証明を管理でき、自分で証明ができる。

**坂本 : **皆んなが賛同してそういうシステム上で、卒業証書や職歴証明書などを提出してくれるとリファレンスチェックに使える。そうなると、証書など自分で持っていて提出が出来たら良いという話なので、ゼロ知識証明が必要とは限らない。世の中では卒業証明書も私的に発行するサービスも既にある。

**Q、**ゼロ知識証明を研究している立場として、ここ数年で大きな環境変化は起きたか。もしくは起きそうか？

**A、**

**長沼:**ゼロ知識証明は 1980 年代からあるが、ブロックチェーンに使われる様になり一気に研究が進歩した。Gcash などを作っている暗号研究者がいきなり大金をゲットして、私はとても驚いた。これまでは暗号研究者のおもちゃの様な、学会の為に論文を書く分野だったが、急にお金に直結する技術になった。

**坂本:**他に、ゼロ知識証明とは少し違うが、日本の国も興味を持っている気がする。Trusted Web 推進協議会を国が立ち上げ、EID みたいなものを基盤に使っていく流れになっている。
そうなると国がブロックチェーンを使って何かを作っていくのかとなれば、大きな変化が起こるのかなと感じている。

### 2.4 まとめ

**伊藤 :** 感想になるが、本日の説明を聞いてゼロ知識証明は何の為に必要かと考えるとブロックチェーンだなと。また長沼さんが言われたブロックチェーンでゼロ知識証明が注目された事に納得したのが、ブロックチェーンの表現で石井さんが言う「物理法則をデジタル」に、持っている物は持っていて所有している事をデジタル上で出来ると言う意味だが、その通りだと思う。でも現実と少し違い不便な所は、現実では家にある所有物は何があるか他の人は分からないが、デジタルで持っている物は全てが曝されている。その事に違和感があったが、その足りたない所にゼロ知識証明によって、より現実に近づきデジタル上の所有物が開示されないので、ブロックチェーンには必須のものかなと思う。

**石井:** まさに透明性とプライバシーの両立と言う所だと思う。国家など垣根が無くなった状態で資産を動かし、資産は今までは通貨だったが、NFT など他のデジタルデータが価値を持ち動いている。そうなればなる程、完全に透明性にする訳にもいかないし秘匿化してしまうのも問題。長沼さんが仰った、80 年代に生まれて理論のみがあったゼロ知識証明がブロックチェーンにより一気に脚光を浴びた事で言うと、今後ブロックチェーンの発展によりこれまで注目されてなかったアルゴリズムや数式などが突然適応されることが相当ありそうだ。AI でも似たような事がある。
